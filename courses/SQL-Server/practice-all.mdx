---
title: 'SQL Server Practice All'
description: 'Complete collection of SQL Server practice exercises'
tags: ['sql-server', 'practice', 'exercises']
visible: true
---
# **[Adventure Works - Database](https://learn.microsoft.com/en-us/sql/samples/adventureworks-install-configure?view=sql-server-ver17&tabs=ssms)**

## SQL Server Practice - Complete Collection



1.1 List all employees hired after January 1, 2012, showing their ID, first name, last name, and hire date, ordered by hire date descending.

1.2 List products with a list price between $100 and $500, showing product ID, name, list price, and product number, ordered by list price ascending.

1.3 List customers from the cities 'Seattle' or 'Portland', showing customer ID, first name, last name, and city, using appropriate joins.

1.4 List the top 15 most expensive products currently being sold, showing name, list price, product number, and category name, excluding discontinued products.

2.1 List products whose name contains 'Mountain' and color is 'Black', showing product ID, name, color, and list price.

2.2 List employees born between January 1, 1970, and December 31, 1985, showing full name, birth date, and age in years.

2.3 List orders placed in the fourth quarter of 2013, showing order ID, order date, customer ID, and total due.

2.4 List products with a null weight but a non-null size, showing product ID, name, weight, size, and product number.

3.1 Count the number of products by category, ordered by count descending.

3.2 Show the average list price by product subcategory, including only subcategories with more than five products.

3.3 List the top 10 customers by total order count, including customer name.

3.4 Show monthly sales totals for 2013, displaying the month name and total amount.

4.1 Find all products launched in the same year as 'Mountain-100 Black, 42'. Show product ID, name, sell start date, and year.

4.2 Find employees who were hired on the same date as someone else. Show employee names, shared hire date, and the count of employees hired that day.

5.1 Create a table named Sales.ProductReviews with columns for review ID, product ID, customer ID, rating, review date, review text, verified purchase flag, and helpful votes. Include appropriate primary key, foreign keys, check constraints, defaults, and a unique constraint on product ID and customer ID.

6.1 Add a column named LastModifiedDate to the Production.Product table, with a default value of the current date and time.

6.2 Create a non-clustered index on the LastName column of the Person.Person table, including FirstName and MiddleName.

6.3 Add a check constraint to the Production.Product table to ensure that ListPrice is greater than StandardCost.

7.1 Insert three sample records into Sales.ProductReviews using existing product and customer IDs, with varied ratings and meaningful review text.

7.2 Insert a new product category named 'Electronics' and a corresponding product subcategory named 'Smartphones' under Electronics.

7.3 Copy all discontinued products (where SellEndDate is not null) into a new table named Sales.DiscontinuedProducts.

8.1 Update the ModifiedDate to the current date for all products where ListPrice is greater than $1000 and SellEndDate is null.

8.2 Increase the ListPrice by 15% for all products in the 'Bikes' category and update the ModifiedDate.

8.3 Update the JobTitle to 'Senior' plus the existing job title for employees hired before January 1, 2010.

9.1 Delete all product reviews with a rating of 1 and helpful votes equal to 0.

9.2 Delete products that have never been ordered, using a NOT EXISTS condition with Sales.SalesOrderDetail.

9.3 Delete all purchase orders from vendors that are no longer active.

10.1 Calculate the total sales amount by year from 2011 to 2014, showing year, total sales, average order value, and order count.

10.2 For each customer, show customer ID, total orders, total amount, average order value, first order date, and last order date.

10.3 List the top 20 products by total sales amount, including product name, category, total quantity sold, and total revenue.

10.4 Show sales amount by month for 2013, displaying the month name, sales amount, and percentage of the yearly total.

11.1 Show employees with their full name, age in years, years of service, hire date formatted as 'Mon DD, YYYY', and birth month name.

11.2 Format customer names as 'LAST, First M.' (with middle initial), extract the email domain, and apply proper case formatting.

11.3 For each product, show name, weight rounded to one decimal, weight in pounds (converted from grams), and price per pound.

12.1 List product name, category, subcategory, and vendor name for products that have been purchased from vendors.

12.2 Show order details including order ID, customer name, salesperson name, territory name, product name, quantity, and line total.

12.3 List employees with their sales territories, including employee name, job title, territory name, territory group, and sales year-to-date.

13.1 List all products with their total sales, including those never sold. Show product name, category, total quantity sold (zero if never sold), and total revenue (zero if never sold).

13.2 Show all sales territories with their assigned employees, including unassigned territories. Show territory name, employee name (null if unassigned), and sales year-to-date.

13.3 Show the relationship between vendors and product categories, including vendors with no products and categories with no vendors.

14.1 List products with above-average list price, showing product ID, name, list price, and price difference from the average.

14.2 List customers who bought products from the 'Mountain' category, showing customer name, total orders, and total amount spent.

14.3 List products that have been ordered by more than 100 different customers, showing product name, category, and unique customer count.

14.4 For each customer, show their order count and their rank among all customers.

15.1 Create a view named vw_ProductCatalog with product ID, name, product number, category, subcategory, list price, standard cost, profit margin percentage, inventory level, and status (active/discontinued).

15.2 Create a view named vw_SalesAnalysis with year, month, territory, total sales, order count, average order value, and top product name.

15.3 Create a view named vw_EmployeeDirectory with full name, job title, department, manager name, hire date, years of service, email, and phone.

15.4 Write three different queries using the views you created, demonstrating practical business scenarios.

16.1 Classify products by price as 'Premium' (greater than $500), 'Standard' ($100 to $500), or 'Budget' (less than $100), and show the count and average price for each category.

16.2 Classify employees by years of service as 'Veteran' (10+ years), 'Experienced' (5-10 years), 'Regular' (2-5 years), or 'New' (less than 2 years), and show salary statistics for each group.

16.3 Classify orders by size as 'Large' (greater than $5000), 'Medium' ($1000 to $5000), or 'Small' (less than $1000), and show the percentage distribution.

17.1 Show products with name, weight (display 'Not Specified' if null), size (display 'Standard' if null), and color (display 'Natural' if null).

17.2 For each customer, display the best available contact method, prioritizing email address, then phone, then address line.

17.3 Find products where weight is null but size is not null, and also find products where both weight and size are null. Discuss the impact on inventory management.

18.1 Create a recursive query to show the complete employee hierarchy, including employee name, manager name, hierarchy level, and path.

18.2 Create a query to compare year-over-year sales for each product, showing product, sales for 2013, sales for 2014, growth percentage, and growth category.

19.1 Rank products by sales within each category, showing product name, category, sales amount, rank, dense rank, and row number.

19.2 Show the running total of sales by month for 2013, displaying month, monthly sales, running total, and percentage of year-to-date.

19.3 Show the three-month moving average of sales for each territory, displaying territory, month, sales, and moving average.

19.4 Show month-over-month sales growth, displaying month, sales, previous month sales, growth amount, and growth percentage.

19.5 Divide customers into four quartiles based on total purchase amount, showing customer name, total purchases, quartile, and quartile average.

20.1 Create a pivot table showing product categories as rows and years (2011-2014) as columns, displaying sales amounts with totals.

20.2 Create a pivot table showing departments as rows and gender as columns, displaying employee count by department and gender.

20.3 Create a dynamic pivot table for quarterly sales, automatically handling an unknown number of quarters.

21.1 Find products sold in both 2013 and 2014, and combine with products sold only in 2013, showing a complete analysis.

21.2 Compare product categories with high-value products (greater than $1000) to those with high-volume sales (more than 1000 units sold), using set operations.

22.1 Declare variables for the current year, total sales, and average order value, and display year-to-date statistics with formatted output.

22.2 Check if a specific product exists in inventory. If it exists, show details; if not, suggest similar products.
    22.3 Generate a monthly sales summary for each month in 2013 using a loop.

22.4 Implement error handling for a product price update operation, including logging errors and rolling back on failure.

23.1 Create a scalar function to calculate customer lifetime value, including total amount spent and weighted recent activity, with parameters for date range and activity weight.

23.2 Create a multi-statement table-valued function to return products by price range and category, including error handling for invalid parameters.

23.3 Create an inline table-valued function to return all employees under a specific manager, including hierarchy level and employee path.

24.1 Create a stored procedure to get products by category, with parameters for category name, minimum price, and maximum price, including parameter validation and error handling.

24.2 Create a stored procedure to update product pricing, including an audit trail, business rule validation, and transaction management.

24.3 Create a stored procedure to generate a comprehensive sales report for a given date range and territory, including summary statistics and detailed breakdowns.

24.4 Create a stored procedure to process bulk orders from XML input, including transaction management, validation, error handling, and returning order confirmation details.

24.5 Create a stored procedure to perform flexible product searches with dynamic filtering by name, category, price range, and date range, returning paginated results and total count.

25.1 Create a trigger on Sales.SalesOrderDetail to update product inventory and maintain sales statistics after insert, including error handling and transaction management.

25.2 Create a view combining multiple tables and implement an INSTEAD OF trigger for insert operations, handling complex business logic and data distribution.

25.3 Create an audit trigger for Production.Product price changes, logging old and new values with timestamp and user information.

26.1 Create a filtered index for active products only (SellEndDate IS NULL) and for recent orders (last 2 years), and measure performance impact.
